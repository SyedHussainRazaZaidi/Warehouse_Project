Insert into silver.crm_prd_info(prd_id,cat_id,prd_key,prd_nm,prd_cost,prd_line,prd_start_dt,prd_end_dt)
select 
prd_id, 
replace(substring(prd_key,1,5),'-','_') as cat_id,
replace(substring(prd_key,7,len(prd_key)),'-','_') as prd_key,
trim(prd_nm) as prd_nm,
coalesce(prd_cost,0) as prd_cost,
case when Upper(prd_line)='M' then 'Mountain'
when Upper(prd_line)='R' then 'Road'
when Upper(prd_line)='S' then 'Other Sales'
when Upper(prd_line)='T' then 'Touring'
else 'n/a'
end as prd_line,
cast(prd_start_dt as date) as prd_start_dt,
cast (lead(prd_start_dt) over (partition by prd_key order by prd_start_dt)-1 as date) as prd_end_dt

from bronze.crm_prd_info

